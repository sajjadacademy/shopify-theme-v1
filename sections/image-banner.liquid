<div class="image-banner section section-{{ section.id }}-padding">
  <div class="image-banner__grid {% if section.settings.layout == 'split' %}grid-split{% endif %}">
    
    {%- for block in section.blocks -%}
    <div class="image-banner__item">
      <div class="image-banner__media banner-media-desktop">
        {% if block.settings.image_desktop != blank %}
          {{ block.settings.image_desktop | image_url: width: 2000 | image_tag: loading: 'lazy', width: 2000 }}
        {% else %}
          {{ 'lifestyle-2' | placeholder_svg_tag: 'placeholder-svg' }}
        {% endif %}
      </div>
      <div class="image-banner__media banner-media-mobile">
        {% if block.settings.image_mobile != blank %}
           {{ block.settings.image_mobile | image_url: width: 800 | image_tag: loading: 'lazy', width: 800 }}
        {% elsif block.settings.image_desktop != blank %}
           {{ block.settings.image_desktop | image_url: width: 800 | image_tag: loading: 'lazy', width: 800 }}
        {% else %}
           {{ 'lifestyle-2' | placeholder_svg_tag: 'placeholder-svg' }}
        {% endif %}
      </div>

      <div class="image-banner__content content-{{ block.settings.text_alignment }}">
        <div class="image-banner__box">
          {% if block.settings.heading != blank %}
            <h2 class="image-banner__heading">{{ block.settings.heading }}</h2>
          {% endif %}
          {% if block.settings.text != blank %}
            <div class="image-banner__text">{{ block.settings.text }}</div>
          {% endif %}
          {% if block.settings.cta_text != blank %}
            <a href="{{ block.settings.cta_link }}" class="btn btn-{{ block.settings.cta_style }}">
              {{ block.settings.cta_text }}
            </a>
          {% endif %}
        </div>
      </div>
    </div>
    {%- endfor -%}

  </div>
</div>

<style>
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top }}px;
    padding-bottom: {{ section.settings.padding_bottom }}px;
  }
  
  .image-banner__grid {
    display: flex;
    flex-direction: column;
    gap: 15px;
  }
  
  .image-banner__item {
    position: relative;
    overflow: hidden;
    width: 100%;
    border-radius: var(--card-radius);
  }
  
  .image-banner__media img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
    min-height: {{ section.settings.mobile_height }}px;
  }
  
  .content-center { text-align: center; justify-content: center; align-items: center; }
  .content-left { text-align: left; justify-content: flex-start; align-items: flex-start; }
  .content-right { text-align: right; justify-content: flex-end; align-items: flex-end; }

  .image-banner__content {
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    padding: 2rem;
    display: flex;
    background: rgba(0,0,0, {{ section.settings.overlay_opacity | divided_by: 100.0 }});
  }
  
  .image-banner__box {
    max-width: 500px;
    color: #ffffff;
  }

  .image-banner__heading {
    font-size: 2rem;
    margin-bottom: 0.5rem;
    color: inherit;
  }
  .image-banner__text {
    margin-bottom: 1.5rem;
    color: inherit;
  }

  @media screen and (max-width: 767px) {
    .banner-media-desktop { display: none !important; }
    .banner-media-mobile { display: block !important; }
  }

  @media screen and (min-width: 768px) {
    .banner-media-mobile { display: none !important; }
    .banner-media-desktop { display: block !important; }

    .image-banner__grid.grid-split {
      flex-direction: row;
    }
    .image-banner__grid.grid-split .image-banner__item {
      width: 50%;
    }
    .image-banner__media img {
        min-height: {{ section.settings.desktop_height }}px;
    }
  }
</style>

{% schema %}
{
  "name": "Image Banner",
  "settings": [
    {
      "type": "select",
      "id": "layout",
      "label": "Layout",
      "options": [
        { "value": "full", "label": "Full Width (Single)" },
        { "value": "split", "label": "Split (Double)" }
      ],
      "default": "full"
    },
    {
      "type": "range",
      "id": "mobile_height",
      "min": 200,
      "max": 600,
      "step": 10,
      "unit": "px",
      "label": "Mobile Height",
      "default": 300
    },
    {
      "type": "range",
      "id": "desktop_height",
      "min": 300,
      "max": 800,
      "step": 10,
      "unit": "px",
      "label": "Desktop Height",
      "default": 500
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "min": 0,
      "max": 90,
      "step": 5,
      "unit": "%",
      "label": "Overlay Opacity",
      "default": 30
    },
    {
       "type": "header",
       "content": "Spacing"
    },
    {
       "type": "range",
       "id": "padding_top",
       "min": 0, "max": 100, "step": 4, "unit": "px", "label": "Top Padding", "default": 20
    },
    {
       "type": "range",
       "id": "padding_bottom",
       "min": 0, "max": 100, "step": 4, "unit": "px", "label": "Bottom Padding", "default": 20
    }
  ],
  "blocks": [
    {
      "type": "banner",
      "name": "Banner",
      "limit": 2,
      "settings": [
        {
          "type": "image_picker",
          "id": "image_desktop",
          "label": "Desktop Image"
        },
        {
          "type": "image_picker",
          "id": "image_mobile",
          "label": "Mobile Image"
        },
        {
           "type": "text",
           "id": "heading",
           "label": "Heading",
           "default": "Banner Heading"
        },
        {
           "type": "richtext",
           "id": "text",
           "label": "Text",
           "default": "<p>Description of the offer.</p>"
        },
        {
           "type": "text",
           "id": "cta_text",
           "label": "Button Label",
           "default": "Shop Now"
        },
        {
           "type": "url",
           "id": "cta_link",
           "label": "Button Link"
        },
        {
           "type": "select",
           "id": "cta_style",
           "label": "Button Style",
           "options": [
              { "value": "primary", "label": "Primary" },
              { "value": "secondary", "label": "Secondary" },
              { "value": "outline", "label": "Outline" }
           ],
           "default": "primary"
        },
        {
           "type": "select",
           "id": "text_alignment",
           "label": "Text Alignment",
           "options": [
              { "value": "left", "label": "Left" },
              { "value": "center", "label": "Center" },
              { "value": "right", "label": "Right" }
           ],
           "default": "center"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Image Banner",
      "blocks": [
        { "type": "banner" }
      ]
    }
  ]
}
{% endschema %}
